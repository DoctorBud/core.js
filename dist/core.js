//(c) Mathigon, 2015
"use strict";!function(n,r){if("function"==typeof define&&define.amd)define(["exports"],r);else if("undefined"!=typeof exports)r(exports);else{var e={exports:{}};r(e.exports),n.core=e.exports}}(this,function(n){function r(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function e(n){if(Array.isArray(n)){for(var r=0,e=Array(n.length);r<n.length;r++)e[r]=n[r];return e}return Array.from(n)}function t(n){return n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n}function a(n){return null==n?""+n:Number.isNaN(n)?"NaN":toString.call(n).match(on)[1].toLowerCase()}function u(n,r){return a(n)===r}function o(n){return n instanceof String||"string"==typeof n}function i(n){return n instanceof Number||"number"==typeof n}function f(n){return n%1===0}function s(n){return"[object Date]"===Object.prototype.toString.call(n)}function c(n){return n instanceof Boolean||"boolean"==typeof n}function l(n){return n===Object(n)}function v(){}function g(){var n=arguments.length<=0||void 0===arguments[0]?10:arguments[0];return Math.random().toString(36).substr(2,n)}function h(n){var r=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],e=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return n instanceof Function?n.apply(e,r):n}function p(n){for(var r=arguments.length,e=Array(r>1?r-1:0),t=1;r>t;t++)e[t-1]=arguments[t];var a=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(a=(i=f.next()).done);a=!0){var s=i.value;if(n===s)return!0}}catch(c){u=!0,o=c}finally{try{!a&&f["return"]&&f["return"]()}finally{if(u)throw o}}return!1}function m(n){for(var r=arguments.length,e=Array(r>1?r-1:0),t=1;r>t;t++)e[t-1]=arguments[t];var a=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(a=(i=f.next()).done);a=!0){var s=i.value;for(var c in s)s.hasOwnProperty(c)&&(n[c]=s[c])}}catch(l){u=!0,o=l}finally{try{!a&&f["return"]&&f["return"]()}finally{if(u)throw o}}return n}function y(n){var r=arguments.length<=1||void 0===arguments[1]?-(1/0):arguments[1],e=arguments.length<=2||void 0===arguments[2]?1/0:arguments[2];return Math.min(e,Math.max(r,n))}function d(n,r,e){return n>=r&&e>=n}function b(n){var r=arguments.length<=1||void 0===arguments[1]?100:arguments[1];window.performance.clearMarks(),window.performance.clearMeasures(),window.performance.mark("start");for(var e=0;r>e;++e)n();window.performance.mark("end"),window.performance.measure("time","start","end");var t=window.performance.getEntriesByName("time")[0].duration;return t/r}function w(n){return n*n}function O(n){return n*n*n}function x(){var n=void 0,r=void 0,e=new Promise(function(e,t){n=e,r=t});return e["catch"](function(n){return n}),{promise:e,resolve:n,reject:r}}function A(n,r){return Object.prototype.hasOwnProperty.call(n,r)}function j(n,r){var e=Array.isArray(n)?[]:{},t=Object.keys(n),a=!0,u=!1,o=void 0;try{for(var i,f=t[Symbol.iterator]();!(a=(i=f.next()).done);a=!0){var s=i.value;e[s]=r(n[s],s)}}catch(c){u=!0,o=c}finally{try{!a&&f["return"]&&f["return"]()}finally{if(u)throw o}}return e}function S(n,r){var e=Object.keys(n),t=!0,a=!1,u=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var f=o.value,s=r(n[f],f);if(null!=s)return s}}catch(c){a=!0,u=c}finally{try{!t&&i["return"]&&i["return"]()}finally{if(a)throw u}}}function _(n){var r=new Map;return function(){for(var e=arguments.length,t=Array(e),a=0;e>a;a++)t[a]=arguments[a];var u=t.join("--");return r.has(u)||r.set(u,n.apply(void 0,t)),r.get(u)}}function k(n,r){var e=!1,t=!1;return function(){for(var a=arguments.length,u=Array(a),o=0;a>o;o++)u[o]=arguments[o];e?t=!0:(n.apply(null,u),e=!0,setTimeout(function(){t&&n.apply(void 0,u),e=!1,t=!1},r))}}function C(n){var r="undefined"==typeof n?"undefined":t(n);return null==n||p(r,"number","string","boolean")?n:n instanceof Number?+n:n instanceof String?""+n:n instanceof Boolean?!!n:n instanceof Date?new Date(n.valueOf()):n instanceof RegExp?new RegExp(n):j(n,function(n){return n})}function M(n){var r="undefined"==typeof n?"undefined":t(n);if(null==n||p(r,"number","string","boolean"))return n;if(n instanceof Number)return+n;if(n instanceof String)return""+n;if(n instanceof Boolean)return!!n;if(n instanceof Date)return new Date(n.valueOf());if(n instanceof RegExp)return new RegExp(n);if(!(n instanceof Object))return n;if(sn.has(n))return sn.get(n);var e=Array.isArray(n)?[]:{};sn.set(n,e);var a=Object.keys(n),u=!0,o=!1,i=void 0;try{for(var f,s=a[Symbol.iterator]();!(u=(f=s.next()).done);u=!0){var c=f.value;e[c]=M(n[c])}}catch(l){o=!0,i=l}finally{try{!u&&s["return"]&&s["return"]()}finally{if(o)throw i}}return e}function N(n){sn=new WeakMap;var r=M(n);return sn=null,r}function E(n,r,e){var t=n[r],a=function(){return t},u=function(n){var r=t;return t=n,e.call(this,n,r)};Object.defineProperty(n,r,{get:a,set:u,enumerable:!0,configurable:!0})}function P(n,r){var e=n[r];delete n[r],n[r]=e}function z(n){return n.trim().split(/\s+/)}function B(n){return n.replace(/\S+/g,function(n){return n.charAt(0).toUpperCase()+n.slice(1)})}function D(n){return n.toLowerCase().replace(/^-/,"").replace(/-(.)/g,function(n,r){return r.toUpperCase()})}function R(n){for(var r=arguments.length<=1||void 0===arguments[1]?1:arguments[1],e=1;r>e;++e)n+=n;return n}function T(n,r){var e=arguments.length<=2||void 0===arguments[2]?" ":arguments[2];if(n.length>=r)return n;var t=r-n.length,a=(Math.ceil(t/e.length),R(e,t).slice(0,t));return a+n}function L(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return n.replace(/\{\{\s*([a-zA-Z]+)\s*(\|\s*([a-zA-Z]+)\s*)?\}\}/g,function(n,e,t,a){var u=r[e]||"";return a&&ln[a]&&(u=ln[a](u)),u})}function Z(n){function r(r){Object.defineProperty(e,r,{get:function(){return n[r]},set:function(e){n[r]!==e&&(n[r]=e,t.get(r).forEach(function(e){e(n[r])}))},enumerable:!0,configurable:!0})}var e={},t=new Map;for(var a in n)r(a);return Object.defineProperty(e,"watch",{value:function(r,e){t.has(r)||t.set(r,[]),t.get(r).push(e),e(n[r])},enumerable:!1,configurable:!1}),Object.defineProperty(e,"unwatch",{value:function(n,r){if(t.has(n)){var e=t.set(n).filter(function(n){return n!==r});t.set(n,e)}},enumerable:!1,configurable:!1}),e}function q(n,r,e){if(!e.length)return h(n,r);for(var t=Array.prototype.slice.call(e,0),a=t.shift(),u=[],o=0;a>o;++o)u.push(q(n,r.concat([o]),t));return u}function U(n){for(var r=arguments.length,e=Array(r>1?r-1:0),t=1;r>t;t++)e[t-1]=arguments[t];return q(n,[],e)}function F(n,r){var e,t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],a=[];if(null==r&&n>=0)for(e=0;n>e;e+=t)a.push(e);else if(null==r)for(e=0;e>n;e-=t)a.push(e);else if(r>=n)for(e=n;r>=e;e+=t)a.push(e);else for(e=n;e>=r;e-=t)a.push(e);return a}function I(n){return n[n.length-1]}function W(n){for(var r,t=arguments.length,a=Array(t>1?t-1:0),u=1;t>u;u++)a[u-1]=arguments[u];var o=(r=Math).max.apply(r,e(a.map(function(n){return n.length})));return U(function(r){return n.apply(void 0,e(arrays.map(function(n){return n[r]})))},o)}function G(n){return n.length?n.reduce(function(n,r){return n+(+r||0)}):0}function H(n,r){return n.map(function(n){return n[r]})}function J(n,r){for(var e={},t=0;t<n.length;++t)e[n[t]]=r[t];return e}function K(n,r){var e=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return n.sort(function(n,t){return e?t[r]-n[r]:n[r]-t[r]})}function Q(n){for(var r=[],e=0;e<n.length;++e)-1===r.indexOf(n[e])&&r.push(n[e]);return r}function V(n){for(var r=[],e=0;e<n.length;++e)null!=n[e]&&r.push(n[e]);return r}function X(n,r){for(var e=[],t=0;t<n.length;++t)n[t]!==r&&e.push(n[t]);return e}function Y(n){for(var r=n.slice.call(0);Array.isArray(r[0]);){for(var t=[],a=0,u=r.length;u>a;++a){var o;t=(o=t).concat.apply(o,e(r[a]))}r=t}return r}function $(n){var r=0;return n.map(function(n){return r+=n})}function nn(n,r){for(var e=[],t=[],a=0,u=n.length,o=0;u>o;++o)t.push(n[o]),++a,a>=r&&(e.push(t),t=[],a=0);return t.length&&e.push(t),e}function rn(n,r){var t=n.length;r=(r%t+t)%t;var a=n.slice(0,r),u=n.slice(r);return u.push.apply(u,e(a)),u}function en(n,r){for(var e=[],t=0;t<n.length;++t)-1===r.indexOf(n[t])&&e.push(n[t]);return e}function tn(n,r){var e=n.length,t=r.length,a=[];n:for(var u=0;e>u;++u){for(var o=n[u],i=0;t>i;++i)if(o===r[i])continue n;a.push(o)}return a}function an(n,r){return r.lowercase&&(n=n.toLowerCase()),n.split(r.split).map(function(n){return n.trim()})}Object.defineProperty(n,"__esModule",{value:!0});var un=function(){function n(n,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}return function(r,e,t){return e&&n(r.prototype,e),t&&n(r,t),r}}(),on=/\s([a-zA-Z]+)/,fn=Object.freeze({typeOf:a,isType:u,isString:o,isNumber:i,isInteger:f,isDate:s,isBoolean:c,isObject:l}),sn=null,cn=Object.freeze({noop:v,uid:g,run:h,isOneOf:p,extend:m,clamp:y,isBetween:d,performance:b,square:w,cube:O,defer:x,has:A,each:j,some:S,cache:_,throttle:k,shallowCopy:C,deepCopy:N,watch:E,unwatch:P}),ln={number:function(n){return n}},vn=Object.freeze({words:z,toTitleCase:B,toCamelCase:D,repeat:R,padStart:T,template:L}),gn=Object.freeze({tabulate:U,list:F,last:I,map:W,total:G,extract:H,zip:J,sortBy:K,unique:Q,clean:V,without:X,flatten:Y,cumulative:$,chunk:nn,rotate:rn,intersect:en,difference:tn}),hn=function(){function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.split,a=void 0===t?" ":t,u=e.lowecase,o=void 0===u?!1:u;r(this,n),this._options={split:a,lowecase:o},this._events={}}return un(n,[{key:"on",value:function(n,r){var e=(arguments.length<=2||void 0===arguments[2]?0:arguments[2],!0),t=!1,a=void 0;try{for(var u,o=an(n,this._options)[Symbol.iterator]();!(e=(u=o.next()).done);e=!0){var i=u.value;i in this._events||(this._events[i]=[]),this._events[i].push(r)}}catch(f){t=!0,a=f}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw a}}}},{key:"one",value:function(n,r){function e(){t.off(n,e),r.apply(void 0,arguments)}var t=this;this.on(n,e)}},{key:"off",value:function(n,r){var e=!0,t=!1,a=void 0;try{for(var u,o=an(n,this._options)[Symbol.iterator]();!(e=(u=o.next()).done);e=!0){var i=u.value;i in this._events&&(this._events[i]=this._events[i].filter(function(n){return n!==r}))}}catch(f){t=!0,a=f}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw a}}}},{key:"trigger",value:function(n){for(var r=arguments.length,e=Array(r>1?r-1:0),t=1;r>t;t++)e[t-1]=arguments[t];var a=!0,u=!1,o=void 0;try{for(var i,f=an(n,this._options)[Symbol.iterator]();!(a=(i=f.next()).done);a=!0){var s=i.value;s in this._events&&this._events[s].forEach(function(n){n.apply(this,e)})}}catch(c){u=!0,o=c}finally{try{!a&&f["return"]&&f["return"]()}finally{if(u)throw o}}}}]),n}();n.arrays=gn,n.Evented=hn,n.observable=Z,n.strings=vn,n.utilities=cn,n.types=fn});